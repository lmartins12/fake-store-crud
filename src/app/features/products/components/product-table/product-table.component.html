<p-table
  [value]="products()"
  [loading]="loading()"
  [paginator]="true"
  [rows]="10"
  [rowsPerPageOptions]="[5, 10, 20]"
  [showCurrentPageReport]="true"
  currentPageReportTemplate="Mostrando {first} a {last} de {totalRecords} produtos"
  [tableStyle]="{ 'min-width': '50rem' }"
  styleClass="p-datatable-striped"
  responsiveLayout="scroll"
>
  <ng-template pTemplate="header">
    <tr>
      <th style="width: 80px">Imagem</th>
      <th pSortableColumn="title">Título <p-sortIcon field="title"></p-sortIcon></th>
      <th pSortableColumn="category" style="width: 180px">
        Categoria <p-sortIcon field="category"></p-sortIcon>
      </th>
      <th pSortableColumn="price" style="width: 120px">
        Preço <p-sortIcon field="price"></p-sortIcon>
      </th>
      <th style="width: 200px; text-align: center">Ações</th>
    </tr>
  </ng-template>

  <ng-template pTemplate="body" let-product>
    @if (!loading()) {
      <tr>
        <td>
          <div class="product-table__image-container">
            @if (product.image) {
              <img
                [src]="product.image"
                [alt]="product.title"
                class="product-table__image"
                (error)="onImageError($event)"
              />
            }
            <div class="product-table__image-fallback" style="display: none">
              <i class="pi pi-image"></i>
            </div>
          </div>
        </td>
        <td>{{ product.title }}</td>
        <td>{{ product.category }}</td>
        <td>{{ product.price | currency: 'BRL' : 'symbol' : '1.2-2' : 'pt-BR' }}</td>
        <td>
          <div class="product-table__actions">
            <p-button
              icon="pi pi-eye"
              [text]="true"
              severity="info"
              (onClick)="onView(product)"
              pTooltip="Visualizar"
              tooltipPosition="top"
            />
            <p-button
              icon="pi pi-pencil"
              [text]="true"
              severity="secondary"
              (onClick)="onEdit(product)"
              pTooltip="Editar"
              tooltipPosition="top"
            />
            <p-button
              icon="pi pi-trash"
              [text]="true"
              severity="danger"
              (onClick)="onDelete(product)"
              pTooltip="Deletar"
              tooltipPosition="top"
            />
          </div>
        </td>
      </tr>
    }
  </ng-template>

  <ng-template pTemplate="emptymessage">
    <tr>
      <td colspan="5" class="product-table__empty">
        <i class="pi pi-inbox product-table__empty-icon"></i>
        <p class="product-table__empty-text">Nenhum produto encontrado</p>
      </td>
    </tr>
  </ng-template>

  <ng-template pTemplate="loadingbody">
    @for (item of skeletonItems; track $index) {
      <tr>
        <td>
          <div class="product-table__skeleton-cell">
            <p-skeleton width="50px" height="50px"></p-skeleton>
          </div>
        </td>
        <td>
          <p-skeleton width="80%" height="1.5rem"></p-skeleton>
        </td>
        <td>
          <p-skeleton width="60%" height="1.5rem"></p-skeleton>
        </td>
        <td>
          <p-skeleton width="50%" height="1.5rem"></p-skeleton>
        </td>
        <td>
          <div class="product-table__skeleton-actions">
            <p-skeleton shape="circle" size="2.5rem"></p-skeleton>
            <p-skeleton shape="circle" size="2.5rem"></p-skeleton>
            <p-skeleton shape="circle" size="2.5rem"></p-skeleton>
          </div>
        </td>
      </tr>
    }
  </ng-template>
</p-table>
